name: Installation CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-mac:

    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v3
    - uses: Homebrew/actions/setup-homebrew@master

    - name: Install brew mac
      run: make brewinstall

    - name: Install brew dependencies
      run: make brewdeps

    - name: Install tpm
      run: make tpm

    - name: Install dependencies Mac
      run: make mac

  build-ubuntu:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - uses: Homebrew/actions/setup-homebrew@master

    - name: Install brew ubuntu
      run: make brewinstall

    - name: Install brew env
      run: make brewenv

    - name: Install brew dependencies
      run: make brewdeps

    - name: Install tpm
      run: make tpm

    - name: Install dotfiles ubuntu
      run: make ubuntu
